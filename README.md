# Analyzing Malware
    Analysis of the Zeus Banking Trojan

<h2>üë©üèª‚ÄçüíªProject Context</h2>

This project is separated into two parts, the first part of the project we created two virtual machines and a host-only network between the VMs. If you are unaware of what I am referring to, see the first part of the project [here](https://github.com/gaelrivera123/MalwareAnalysisLab/tree/main). When it comes to malware analysis, security practictioners may either used self-hosted labs or cloud-hosted labs, however, in this specific project we will be using self-hosted labs to analyze our malware. During this portion of the project, we will utilize popular malware analysis tools and techniques in order to gain further understanding of our malware sample.

<h2>üëæHistory of Zeus Banking Trojan</h2>

- <b>Initially created to extract financial information</b>
- <b>First identified in 2007</b>
  - Since its identification in 2007, there are over 578+ versions of the malware and 36 families
- <b>Code became leaked in 2011 which sparked new versions of the malware, but also led to further information on the suspected author, Evgeniy
Mikhailovich Bogachev. He currently has a bounty of $3 million on him set by the FBI</b>
- <b>Methods of Delivery</b>
  - Drive-by downloads: Requires user to visit a site and unsuspectingly download the trojan. Mostly obselete since most websites block malicious downloads by default.
  - Phishing: Social Engineering Method which imitates a legimitate source and preys on unsuspecting users. Main method.
- <b>Trojan's Intentions</b>
  - Steal financial information
  - Add infected machines to a botnet
    - A botnet is a collection of infected machines which are used for mass-attacks, such as spam emails, phishing, DDoS attacks etc.
- <b>Impact</b>
  - Inspired hundreds of variants which utilize leaked source code
  - Led to infection of millions of computers
  - Over $100 million in damages

<h2>‚úÖProject Prerequisites</h2>

  - <b>Self-hosted lab</b>
    - Cloud-hosted works, but steps may be slightly different
  - <b>Snapshot of base image</b>
  - <b>Internet Connection</b>

<h2>üõ†Ô∏èMalware Analysis Tools Overview</h2>

<h3>Static Tools</h3>

- <b>VirusTotal</b>
  - Analysis tool which reviews malicious files, domains, IPs, and URLs to detect malware
  - Collects results of antivirus services and online security engines which have flagged the malicious file as being a threat.
  - Used to measure its functionality against established security engines.

- <b>PeStudio</b>
  - Statically analyzes malware and identifies artifacts of interest</b>
  - Collects metadata:
    - Hashes
    - Header
    - Properties
    - Libraries Used
    - Imports
    - Strings

- <b>Floss</b>
  - Extracts strings from executables
  - Uses advanced static analysis technique to make strings from malware binaries much easier to understand (deobsfucation)

- <b>Capa</b>
  - Detects capabilities of program and outputs what it thinks it may accomplish
  - Rules matched against previously known API calls, strings of interest etc.
  - Behavior mapped to MITRE ATT&CK framework
    - MITRE ATT&CK framework is a guideline for classifying and describing cyberattacks. Essentially the knowledge and base model for cyber adversary behavior.

- <b>Cutter</b>
  - Reverse-Engineering platform
    - Reverse-Engineering refers to the process of deconstruction of a program to better understand its functionalities
  - Used to view assembly-level instructions of a program
    - Assembly language is a low-level programming "language" intended to communicate directly with a computer's hardware. Can reveal how malware directly communicates with a computer.
  - View decompiled code
 
<h3>Dynamic Tools</h3>

- <b>INetSim</b>
  - Used to simulate common internet services
  - Used to analyze network behavior changes caused by malware

- <b>Wireshark</b>
  - Network packet sniffer and analyzer. Used for troubleshooting a network and analyzing its packets
  - In malware analysis, it can:
    - View ingoing/outgoing network traffic from malicious programs
    - Flag domains or IPs that are being reached out to from the malicious program
   
- <b>Process Monitor</b>
  - Monitors and displays real-time info on Windows filesystem,
  - Captures events from 5 different categories
    - Registry
    - Filesystem
    - Network
    - Processes
    - Profiling Events
  - Used to view malicious changed to filesystem

 - <b>YARA</b>
   - Helps classify and identify malware samples by grouping it with malware families based on textual or binary patterns
   - Can help better identify malicious files since it focuses on finding malware families associated with the sample malware
   - Exploits code similarities between malware samples within a family
